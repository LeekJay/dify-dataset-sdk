# 标签与元数据 (Tags) 模块

标签模块提供知识库标签和文档元数据的管理功能。

## 方法列表

### 标签操作

| 方法                    | 描述             |
| ----------------------- | ---------------- |
| `create()`              | 创建标签         |
| `list()`                | 获取标签列表     |
| `update()`              | 更新标签         |
| `delete()`              | 删除标签         |
| `bind_to_dataset()`     | 绑定标签到数据集 |
| `unbind_from_dataset()` | 解绑标签         |
| `get_dataset_tags()`    | 获取数据集的标签 |

### 元数据操作

| 方法                         | 描述                |
| ---------------------------- | ------------------- |
| `create_metadata()`          | 创建元数据字段      |
| `list_metadata()`            | 获取元数据字段列表  |
| `update_metadata()`          | 更新元数据字段      |
| `delete_metadata()`          | 删除元数据字段      |
| `toggle_built_in_metadata()` | 启用/禁用内置元数据 |
| `update_document_metadata()` | 更新文档元数据值    |

---

## create() - 创建标签

创建新的知识库类型标签。

### 参数

| 参数   | 类型 | 必填 | 描述                     |
| ------ | ---- | ---- | ------------------------ |
| `name` | str  | 是   | 标签名称（最多 50 字符） |

### 返回值

`KnowledgeTag` - 创建的标签信息

### 示例

```python
tag = client.tags.create(name="技术文档")
print(f"标签 ID: {tag.id}")
print(f"标签名称: {tag.name}")
```

---

## list() - 获取标签列表

获取所有知识库类型标签。

### 参数

无

### 返回值

`List[KnowledgeTag]` - 标签列表

### 示例

```python
tags = client.tags.list()
for tag in tags:
    print(f"{tag.name}: {tag.id}")
```

---

## update() - 更新标签

更新标签名称。

### 参数

| 参数     | 类型 | 必填 | 描述                       |
| -------- | ---- | ---- | -------------------------- |
| `tag_id` | str  | 是   | 标签 ID                    |
| `name`   | str  | 是   | 新标签名称（最多 50 字符） |

### 返回值

`KnowledgeTag` - 更新后的标签信息

### 示例

```python
tag = client.tags.update(
    tag_id="tag-id",
    name="新标签名称"
)
print(f"更新成功: {tag.name}")
```

---

## delete() - 删除标签

删除知识库类型标签。

### 参数

| 参数     | 类型 | 必填 | 描述    |
| -------- | ---- | ---- | ------- |
| `tag_id` | str  | 是   | 标签 ID |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
result = client.tags.delete(tag_id="tag-id")
print("标签删除成功")
```

---

## bind_to_dataset() - 绑定标签到数据集

将标签绑定到知识库。

### 参数

| 参数         | 类型      | 必填 | 描述         |
| ------------ | --------- | ---- | ------------ |
| `dataset_id` | str       | 是   | 数据集 ID    |
| `tag_ids`    | List[str] | 是   | 标签 ID 列表 |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
# 绑定单个标签
result = client.tags.bind_to_dataset(
    dataset_id="dataset-id",
    tag_ids=["tag-id"]
)

# 绑定多个标签
result = client.tags.bind_to_dataset(
    dataset_id="dataset-id",
    tag_ids=["tag-id-1", "tag-id-2", "tag-id-3"]
)
print("绑定成功")
```

---

## unbind_from_dataset() - 解绑标签

解除数据集与标签的绑定。

### 参数

| 参数         | 类型 | 必填 | 描述      |
| ------------ | ---- | ---- | --------- |
| `dataset_id` | str  | 是   | 数据集 ID |
| `tag_id`     | str  | 是   | 标签 ID   |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
result = client.tags.unbind_from_dataset(
    dataset_id="dataset-id",
    tag_id="tag-id"
)
print("解绑成功")
```

---

## get_dataset_tags() - 获取数据集的标签

获取绑定到数据集的所有标签。

### 参数

| 参数         | 类型 | 必填 | 描述      |
| ------------ | ---- | ---- | --------- |
| `dataset_id` | str  | 是   | 数据集 ID |

### 返回值

`List[KnowledgeTag]` - 绑定的标签列表

### 示例

```python
tags = client.tags.get_dataset_tags(dataset_id="dataset-id")
for tag in tags:
    print(f"标签: {tag.name}")
```

---

## create_metadata() - 创建元数据字段

为数据集创建自定义元数据字段。

### 参数

| 参数         | 类型 | 必填 | 描述                                 |
| ------------ | ---- | ---- | ------------------------------------ |
| `dataset_id` | str  | 是   | 数据集 ID                            |
| `field_type` | str  | 是   | 字段类型：`string`、`number`、`time` |
| `name`       | str  | 是   | 字段名称                             |

### 返回值

`Metadata` - 创建的元数据字段信息

### 示例

```python
# 创建字符串类型字段
metadata = client.tags.create_metadata(
    dataset_id="dataset-id",
    field_type="string",
    name="作者"
)

# 创建数字类型字段
metadata = client.tags.create_metadata(
    dataset_id="dataset-id",
    field_type="number",
    name="版本号"
)

# 创建时间类型字段
metadata = client.tags.create_metadata(
    dataset_id="dataset-id",
    field_type="time",
    name="发布日期"
)

print(f"元数据字段 ID: {metadata.id}")
```

---

## list_metadata() - 获取元数据字段列表

获取数据集的所有元数据字段。

### 参数

| 参数         | 类型 | 必填 | 描述      |
| ------------ | ---- | ---- | --------- |
| `dataset_id` | str  | 是   | 数据集 ID |

### 返回值

`MetadataListResponse` - 元数据字段列表

### 示例

```python
result = client.tags.list_metadata(dataset_id="dataset-id")

# 内置字段
for field in result.doc_metadata:
    print(f"内置字段: {field.name} ({field.type})")

# 自定义字段
for field in result.doc_metadata:
    if not field.get("built_in", False):
        print(f"自定义字段: {field.name}")
```

---

## update_metadata() - 更新元数据字段

更新元数据字段名称。

### 参数

| 参数          | 类型 | 必填 | 描述          |
| ------------- | ---- | ---- | ------------- |
| `dataset_id`  | str  | 是   | 数据集 ID     |
| `metadata_id` | str  | 是   | 元数据字段 ID |
| `name`        | str  | 是   | 新字段名称    |

### 返回值

`Metadata` - 更新后的元数据字段信息

### 示例

```python
metadata = client.tags.update_metadata(
    dataset_id="dataset-id",
    metadata_id="metadata-id",
    name="新字段名称"
)
print(f"更新成功: {metadata.name}")
```

---

## delete_metadata() - 删除元数据字段

删除自定义元数据字段。

### 参数

| 参数          | 类型 | 必填 | 描述          |
| ------------- | ---- | ---- | ------------- |
| `dataset_id`  | str  | 是   | 数据集 ID     |
| `metadata_id` | str  | 是   | 元数据字段 ID |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
result = client.tags.delete_metadata(
    dataset_id="dataset-id",
    metadata_id="metadata-id"
)
print("元数据字段删除成功")
```

---

## toggle_built_in_metadata() - 启用/禁用内置元数据

启用或禁用内置的元数据字段。

### 参数

| 参数         | 类型 | 必填 | 描述                        |
| ------------ | ---- | ---- | --------------------------- |
| `dataset_id` | str  | 是   | 数据集 ID                   |
| `action`     | str  | 是   | 操作：`enable` 或 `disable` |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
# 禁用内置元数据
result = client.tags.toggle_built_in_metadata(
    dataset_id="dataset-id",
    action="disable"
)

# 启用内置元数据
result = client.tags.toggle_built_in_metadata(
    dataset_id="dataset-id",
    action="enable"
)
```

---

## update_document_metadata() - 更新文档元数据值

更新文档的元数据值。

### 参数

| 参数             | 类型 | 必填 | 描述               |
| ---------------- | ---- | ---- | ------------------ |
| `dataset_id`     | str  | 是   | 数据集 ID          |
| `operation_data` | List | 是   | 文档元数据操作列表 |

### operation_data 结构

每个操作包含：

| 字段            | 类型 | 描述       |
| --------------- | ---- | ---------- |
| `document_id`   | str  | 文档 ID    |
| `metadata_list` | List | 元数据列表 |

metadata_list 中每个元素：

| 字段    | 类型 | 描述          |
| ------- | ---- | ------------- |
| `id`    | str  | 元数据字段 ID |
| `value` | Any  | 元数据值      |
| `name`  | str  | 字段名称      |

### 返回值

`Dict[str, Any]` - 成功响应

### 示例

```python
result = client.tags.update_document_metadata(
    dataset_id="dataset-id",
    operation_data=[
        {
            "document_id": "doc-id-1",
            "metadata_list": [
                {"id": "metadata-id-1", "value": "张三", "name": "作者"},
                {"id": "metadata-id-2", "value": "1.0", "name": "版本号"}
            ]
        },
        {
            "document_id": "doc-id-2",
            "metadata_list": [
                {"id": "metadata-id-1", "value": "李四", "name": "作者"}
            ]
        }
    ]
)
print("元数据更新成功")
```

---

## 数据模型

### KnowledgeTag

```python
class KnowledgeTag:
    id: str                      # 标签 ID
    name: str                    # 标签名称
    type: str                    # 标签类型
    binding_count: int           # 绑定数量
```

### Metadata

```python
class Metadata:
    id: str                      # 元数据字段 ID
    type: str                    # 字段类型：string, number, time
    name: str                    # 字段名称
```

### DocumentMetadata

```python
class DocumentMetadata:
    document_id: str             # 文档 ID
    metadata_list: List[MetadataItem]  # 元数据列表
```
